// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
	provider = "prisma-client-js"
}

datasource db {
	provider = "postgresql"
	url      = env("DATABASE_URL")
}

model Post {
	id			Int			@id @default(autoincrement())
	createdAt	DateTime	@default(now())
	updatedAt	DateTime	@updatedAt
	title		String		@db.Text
	content		String		@db.Text
	published	Boolean		@default(false)
	likes		Int			@default(0)
	author		User		@relation(fields: [authorId], references: [id])
	tags		Tag[]
	authorId 	Int
	comments 	Comment[]
}

model Comment {
	id			Int			@id @default(autoincrement())
	createdAt	DateTime	@default(now())
	updatedAt	DateTime	@updatedAt
	content		String		@db.Text
	edited		Boolean		@default(false)
	likes		Int			@default(0)
	depth		Int
	parent		Comment?	@relation("commentLineageRel", fields: [parentId], references: [id])
	parentId	Int?
	children 	Comment[]	@relation("commentLineageRel")
	postId		Int
	post		Post		@relation(fields: [postId], references: [id])
	author		User		@relation(fields: [authorId], references: [id])
	authorId 	Int
}

model Profile {
	id		Int		@id	@default(autoincrement())
	bio		String?	@db.Text
	user	User	@relation(fields: [userId], references: [id])
	userId	Int
}

model Permissions {
	id			Int		@id	@default(autoincrement())
	admin		Boolean	@default(false)
	moderator	Boolean	@default(false)
	post		Boolean	@default(false)
	comment		Boolean	@default(true)
	user		User	@relation(fields: [userId], references: [id])
	userId		Int
}

model User {
	id			Int				@id	@default(autoincrement())
	email		String			@unique
	firstName	String			@db.VarChar(25)
	lastName	String			@db.VarChar(25)
	posts		Post[]
	comments 	Comment[]
	profile		Profile?
	permissions Permissions?
}

model Tag {
	name	String	@id	@db.Text @unique
	color	String
	posts	Post[]
}
